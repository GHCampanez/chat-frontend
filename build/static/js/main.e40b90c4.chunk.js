(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{38:function(e,t,a){e.exports=a(67)},66:function(e,t,a){},67:function(e,t,a){"use strict";a.r(t);var n=a(37),r=a(0),s=a.n(r),c=a(33),o=a.n(c),l=a(5),i=a(6),m=a(9),u=a(7),d=a(8),p=a(18),h=a(14),b=a.n(h),f=a(19),v={state:!1,user:{},token:""},g=a(13),E=a.n(g),N=a(11),y=E.a.create({baseURL:"http://localhost:5000",headers:{Authorization:"Bearer "+v.token}}),w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleForm=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),""===a.state.name||""===a.state.password){e.next=6;break}return e.next=4,y.post("/user/verify",{name:a.state.name,password:a.state.password}).then((function(e){v.state=!0,v.token=e.data.token,v.user=e.data.user.name,a.props.history.push("/chat/".concat(e.data.user.name))})).catch((function(e){e.request&&(console.error(e.request.response),a.setState({warning:"Please, check your username and password"}))}));case 4:e.next=7;break;case 6:a.setState({warning:"Please, check your username and password"});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={users:{},name:"",password:"",warning:""},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-8"},s.a.createElement("h2",null,"Login"),s.a.createElement("form",{onSubmit:function(t){return e.handleForm(t)}},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Name"),s.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},name:"name",type:"text",className:"form-control",value:this.state.name,id:"name",placeholder:"Enter a name"})),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Password"),s.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"password",className:"form-control",value:this.state.password,id:"password",name:"password",placeholder:"Password"})),s.a.createElement("small",{className:"form-text text-danger"},this.state.warning),s.a.createElement("button",{type:"submit",className:"btn btn-primary"},"Sign in"),s.a.createElement("button",{type:"button",onClick:function(){return e.props.history.push("/signup")},className:"btn btn-secondary m-2"},"Sign up")))))}}]),t}(s.a.Component),O=Object(N.g)(w),k=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(O,null))}}]),t}(s.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var j=a(36),C=a(17),x=(a(66),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).componentWillMount=function(){a.buildApi().get("/chat/users").then((function(e){var t=e.data.filter((function(e){return e.name!==a.state.user}));a.setState({users:t})}))},a.buildApi=function(){return E.a.create({baseURL:"http://localhost:5000",headers:{Authorization:"Bearer "+v.token}})},a.sendMessage=function(){var e=a.buildApi(),t=[].concat(Object(j.a)(a.state.messages),[{message:a.state.message,user:a.state.user}]);e.post("/chat/conversation",{chatName:a.state.chatName,messages:t}),a.setState({messages:t}),a.setState({message:""})},a.selectFriend=function(e){var t=a.buildChatName(e.name,a.state.user);a.setState({chatName:t}),a.getChat(t)},a.getChat=function(e){console.log("Buscando chat  ".concat(e));var t=a.buildApi();""!==e&&t.get("/chat/conversation?chat=".concat(e)).then((function(e){a.setState({messages:e.data.messages})}))},a.state={user:a.props.match.params.user,message:"",messages:[],users:[{id:1,name:"Pedro"},{id:2,name:"Matheus"}],chatName:"",interval:setInterval(function(){this.getChat(this.state.chatName)}.bind(Object(C.a)(a)),3e3)},console.log(v),a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"buildChatName",value:function(e,t){var a=(e+t).replace(/\s+/g,"").split("");return a.sort(),a=a.join("")}},{key:"signOut",value:function(){clearInterval(this.state.interval),v.state=!1,v.token="",v.user="",this.props.history.push("/")}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-12"},s.a.createElement("div",{className:"card"},s.a.createElement("div",{className:"card-body"},s.a.createElement("div",{className:"card-title"},s.a.createElement("h2",null,"Global Chat"),s.a.createElement("span",null,"Welcome ",this.state.user)),s.a.createElement("hr",null),s.a.createElement("div",{className:"messages scroll "},this.state.messages.map((function(e){return s.a.createElement("div",null,e.user,": ",e.message)})))),s.a.createElement("div",{className:"card-footer"},s.a.createElement("input",{type:"text",placeholder:"Message",className:"form-control",value:this.state.message,onChange:function(t){return e.setState({message:t.target.value})}}),s.a.createElement("br",null),s.a.createElement("button",{onClick:function(){return e.sendMessage()},className:"btn btn-primary form-control"},"Send"),s.a.createElement("br",null),s.a.createElement("br",null),s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-toggle":"modal","data-target":"#exampleModal"},"Find a friend"),s.a.createElement("button",{type:"button",className:"btn btn-danger m-2",onClick:function(){return e.signOut()}},"Sign Out"))))),s.a.createElement("div",{className:"modal fade",id:"exampleModal",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},s.a.createElement("div",{className:"modal-dialog",role:"document"},s.a.createElement("div",{className:"modal-content"},s.a.createElement("div",{className:"modal-header"},s.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Find a Friend"),s.a.createElement("button",{type:"button",className:"close","data-dismiss":"modal","aria-label":"Close"},s.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),s.a.createElement("div",{className:"modal-body"},s.a.createElement("div",{className:"list-group"},this.state.users.map((function(t){return s.a.createElement("button",{key:t._id,type:"submit",onClick:function(){return e.selectFriend(t)},"data-dismiss":"modal",className:"list-group-item list-group-item-action"},t.name)})))),s.a.createElement("div",{className:"modal-footer"},s.a.createElement("button",{type:"button",className:"btn btn-secondary","data-dismiss":"modal"},"Close"))))))}}]),t}(s.a.Component)),S=Object(N.g)(x),F=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement("center",null,s.a.createElement("pre",null,"Have patience, come back later."),s.a.createElement("footer",null,"UTFPR")))}}]),t}(s.a.Component),I=a(15),M=E.a.create({baseURL:"http://localhost:5000",headers:{Authorization:"Bearer "+v.token}}),A=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(u.a)(t).call(this,e))).handleForm=function(){var e=Object(f.a)(b.a.mark((function e(t){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,M.post("/user/register",{name:a.state.name,password:a.state.password,createdAt:new Date}).then((function(e){v.state=!0,v.token=e.data.token,v.user=e.data.user,a.props.history.push("/")})).catch((function(e){e.request&&(console.error(e.request.response),alert(e.request.response))}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.state={users:{},name:"",password:""},a}return Object(d.a)(t,e),Object(i.a)(t,[{key:"handleInputChange",value:function(e){var t=e.target,a="checkbox"===t.type?t.checked:t.value,n=t.name;this.setState(Object(p.a)({},n,a))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"container"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-8"},s.a.createElement("h2",null,"SingUp"),s.a.createElement("form",{onSubmit:function(t){return e.handleForm(t)}},s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Name"),s.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},name:"name",type:"text",className:"form-control",value:this.state.name,id:"name",placeholder:"Enter a name"}),s.a.createElement("small",{id:"nameHelp",className:"form-text text-muted"},"Your information is safe with us.")),s.a.createElement("div",{className:"form-group"},s.a.createElement("label",null,"Password"),s.a.createElement("input",{onChange:function(t){return e.handleInputChange(t)},type:"password",className:"form-control",value:this.state.password,id:"password",name:"password",placeholder:"Password"})),s.a.createElement("button",{type:"submit",className:"btn btn-info"},"Submit")))))}}]),t}(r.Component),P=Object(N.g)(A),B=s.a.createElement(I.a,null,s.a.createElement(N.d,null,s.a.createElement(N.b,{exact:!0,path:"/",component:k}),s.a.createElement(N.b,{exact:!0,path:"/signup",component:P}),s.a.createElement((function(e){var t=e.component,a=Object(n.a)(e,["component"]);return s.a.createElement(N.b,Object.assign({},a,{render:function(e){return v.state?s.a.createElement(t,e):s.a.createElement(N.a,{to:{pathname:"/",state:{from:e.location}}})}}))}),{exact:!0,path:"/chat/:user",component:S}),s.a.createElement(N.b,{component:F})));o.a.render(B,document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[38,1,2]]]);
//# sourceMappingURL=main.e40b90c4.chunk.js.map